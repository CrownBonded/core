
var iconv = require('iconv-lite')


function encoding (req, options) {
  req.on('response', function (res) {
    if (req._redirect) return
    // probably should detect the content encoding somehow
    var encoding = (typeof options.encoding === 'string')
      ? options.encoding : 'utf8'

    req._res = (req._res || res).pipe(iconv.decodeStream(encoding))
  })
}

module.exports = encoding
