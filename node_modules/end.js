
function end (req, options) {
  if (options.end === false) return

  if (
    // not started
    !req._started &&
    // not piped
    !req._src &&
    // not keep-alive
    (!options.agent || !options.agent.keepAlive)
  ) {
    req.end()
  }
}

module.exports = end
